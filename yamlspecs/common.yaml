---
- category: perl module
  versions: !include versions.yaml 
  extension: tar.gz
  download_file: "{{name}}-{{version}}.{{extension}}"
  src_tarball: "{{download_file}}"
  pkgname: "perl_{{versions.perl}}-{{name}}"

  root: "{{pkg_defaults.app_path}}/perl/{{versions.perl}}"
  prefix: "{{root}}" 

  addfile: 
    - listRpmFiles.py

  build:
    configure: >
      export PERL_MM_USE_DEFAULT=true; 
      if [ -f Makefile.PL ]; then \
        perl Makefile.PL ; \
      elif [ -f Build.PL ]; then \
        perl Build.PL --prefix=$(PKGROOT); \
      fi; \
      unset PERL_MM_USE_DEFAULT
    configure_args:
    modules: 
      - "perl/{{versions.perl}}"
    target: 

  install:
    makeinstall: >
      if [ -f Makefile.PL ]; then \
        $(MAKE); $(MAKE) DESTDIR=$(ROOT) pure_install; \
      elif [ -f Build.PL ]; then \
        perl Build; perl Build --destdir=$(ROOT) pure_install; \
      fi ; 
      (cd ..;  python listRpmFiles.py $(ROOT))

  fileslist: LISTFILES

  requires:
     - perl_{{versions.perl}}
