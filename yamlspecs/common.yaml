---
- category: perl module
  versions: !include perl_versions.yaml 
  extension: tar.gz
  download_file: "{{ name }}-{{ version  }}.{{ extension }}"
  src_tarball: "{{ download_file }}"
  pkgname: "perl_{{ versions.perl }}-{{ name }}"

  root: "{{ pkg_defaults.app_path }}/perl/{{ versions.perl }}"
  prefix: "{{ root }}" 

  compiler: gcc
  compiler_version: "{{ versions.gcc }}"

  addfile: 
    - filter-requires-perlmodules.sh
    - filter-provides-perlmodules.sh
    - listRpmFiles.py

  build:
    configure: >
      if [ -f Makefile.PL ]; then \
        perl Makefile.PL INSTALLL_BASE=$(PKGROOT); \
      elif [ -f Build.PL ]; then \
        perl Build.PL --prefix=$(PKGROOT); \
      fi
    configure_args:
    modules: 
      - "perl/{{ versions.perl }}"
    target: 

  install:
    makeinstall: >
      if [ -f Makefile.PL ]; then \
        $(MAKE); $(MAKE) DESTDIR=$(ROOT) pure_install; \
      elif [ -f Build.PL ]; then \
        perl Build; perl Build --destdir=$(ROOT) pure_install; \
      fi ; 
      (cd ..;  python listRpmFiles.py $(ROOT))

  fileslist: LISTFILES

  rpm: !include rpm.extras.perlmodules.yaml

